{
  "version": 3,
  "sources": ["../../../srcts/src/components/webcomponents/_makeInputBinding.ts", "../../../srcts/src/components/_utils.ts", "../../../srcts/src/components/codeEditor.ts"],
  "sourcesContent": ["export interface CustomElementInputValue<T> extends HTMLElement {\n  id: string;\n  value: T;\n  onChangeCallback: (x: boolean) => void;\n  receiveMessage: (el: HTMLElement, data: { [key: string]: any }) => void;\n}\n\nexport interface CustomElementInputGetValue<T> extends HTMLElement {\n  id: string;\n  getValue: () => T;\n  onChangeCallback: (x: boolean) => void;\n  receiveMessage: (el: HTMLElement, data: { [key: string]: any }) => void;\n}\n\nexport type CustomElementInput<T> =\n  | CustomElementInputGetValue<T>\n  | CustomElementInputValue<T>;\n\n/**\n * Given a tag name for a custom element that is a CustomElementInput<T>, this\n * will hook up the proper input binding and register it with Shiny.\n * @param tagName Name of the tag that corresponds to the input binding\n * @returns Nothing\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function makeInputBinding<T>(\n  tagName: string,\n  { type = null }: { type?: string | null } = {}\n) {\n  if (!window.Shiny) {\n    return;\n  }\n\n  class NewCustomBinding extends window.Shiny[\"InputBinding\"] {\n    constructor() {\n      super();\n    }\n\n    find(scope: HTMLElement): JQuery<CustomElementInput<T>> {\n      return $(scope).find(tagName) as JQuery<CustomElementInput<T>>;\n    }\n\n    getValue(el: CustomElementInputGetValue<T> | CustomElementInputValue<T>) {\n      if (\"getValue\" in el) {\n        return el.getValue();\n      } else {\n        return el.value;\n      }\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getType(el: CustomElementInput<T>): string | null {\n      return type;\n    }\n\n    subscribe(el: CustomElementInput<T>, callback: (x: boolean) => void): void {\n      el.onChangeCallback = callback;\n    }\n\n    unsubscribe(el: CustomElementInput<T>): void {\n      // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-unused-vars\n      el.onChangeCallback = (x: boolean) => {};\n    }\n\n    receiveMessage(\n      el: CustomElementInput<T>,\n      data: { [key: string]: any }\n    ): void {\n      el.receiveMessage(el, data);\n    }\n  }\n\n  window.Shiny.inputBindings.register(\n    new NewCustomBinding(),\n    `${tagName}-Binding`\n  );\n}\n", "import type { HtmlDep } from \"rstudio-shiny/srcts/types/src/shiny/render\";\n\nimport type { InputBinding as InputBindingType } from \"rstudio-shiny/srcts/types/src/bindings/input\";\n\nimport type { ShinyClass } from \"rstudio-shiny/srcts/types/src\";\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst Shiny: ShinyClass | undefined = window.Shiny;\n\n// Exclude undefined from T\ntype NotUndefined<T> = T extends undefined ? never : T;\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nconst InputBinding = (\n  Shiny ? Shiny.InputBinding : class {}\n) as typeof InputBindingType;\n\nfunction registerBinding(\n  inputBindingClass: new () => InputBindingType,\n  name: string\n): void {\n  if (Shiny) {\n    Shiny.inputBindings.register(new inputBindingClass(), \"bslib.\" + name);\n  }\n}\n\nfunction registerBslibGlobal(name: string, value: object): void {\n  (window as any).bslib = (window as any).bslib || {};\n  if (!(window as any).bslib[name]) {\n    (window as any).bslib[name] = value;\n  } else {\n    console.error(\n      `[bslib] Global window.bslib.${name} was already defined, using previous definition.`\n    );\n  }\n}\n\ntype ShinyClientMessage = {\n  message: string;\n  headline?: string;\n  status?: \"error\" | \"info\" | \"warning\";\n};\n\nfunction showShinyClientMessage({\n  headline = \"\",\n  message,\n  status = \"warning\",\n}: ShinyClientMessage): void {\n  document.dispatchEvent(\n    new CustomEvent(\"shiny:client-message\", {\n      detail: { headline: headline, message: message, status: status },\n    })\n  );\n}\n\n// Return true if the key exists on the object and the value is not undefined.\n//\n// This method is mainly used in input bindings' `receiveMessage` method.\n// Since we know that the values are sent by Shiny via `{jsonlite}`,\n// then we know that there are no `undefined` values. `null` is possible, but not `undefined`.\nfunction hasDefinedProperty<\n  Prop extends keyof X,\n  X extends { [key: string]: any }\n>(\n  obj: X,\n  prop: Prop\n): obj is X & { [key in NonNullable<Prop>]: NotUndefined<X[key]> } {\n  return (\n    Object.prototype.hasOwnProperty.call(obj, prop) && obj[prop] !== undefined\n  );\n}\n\n// TODO: Shiny should trigger resize events when the output\n// https://github.com/rstudio/shiny/pull/3682\nfunction doWindowResizeOnElementResize(el: HTMLElement): void {\n  if ($(el).data(\"window-resize-observer\")) {\n    return;\n  }\n  const resizeEvent = new Event(\"resize\");\n  const ro = new ResizeObserver(() => {\n    window.dispatchEvent(resizeEvent);\n  });\n  ro.observe(el);\n  $(el).data(\"window-resize-observer\", ro);\n}\n\nfunction getAllFocusableChildren(el: HTMLElement): HTMLElement[] {\n  // Cross-referenced with https://allyjs.io/data-tables/focusable.html\n  const base = [\n    \"a[href]\",\n    \"area[href]\",\n    \"button\",\n    \"details summary\",\n    \"input\",\n    \"iframe\",\n    \"select\",\n    \"textarea\",\n    '[contentEditable=\"\"]',\n    '[contentEditable=\"true\"]',\n    '[contentEditable=\"TRUE\"]',\n    \"[tabindex]\",\n  ];\n  const modifiers = [':not([tabindex=\"-1\"])', \":not([disabled])\"];\n  const selectors = base.map((b) => b + modifiers.join(\"\"));\n  const focusable = el.querySelectorAll(selectors.join(\", \"));\n  return Array.from(focusable) as HTMLElement[];\n}\n\nasync function shinyRenderContent(\n  ...args: Parameters<ShinyClass[\"renderContentAsync\"]>\n): Promise<void> {\n  if (!Shiny) {\n    throw new Error(\"This function must be called in a Shiny app.\");\n  }\n  if (Shiny.renderContentAsync) {\n    return await Shiny.renderContentAsync.apply(null, args);\n  } else {\n    return await Shiny.renderContent.apply(null, args);\n  }\n}\n\n// Copied from shiny utils\nasync function updateLabel(\n  labelContent: string | { html: string; deps: HtmlDep[] } | undefined,\n  labelNode: JQuery<HTMLElement>\n): Promise<void> {\n  // Only update if label was specified in the update method\n  if (typeof labelContent === \"undefined\") return;\n  if (labelNode.length !== 1) {\n    throw new Error(\"labelNode must be of length 1\");\n  }\n\n  if (typeof labelContent === \"string\") {\n    labelContent = {\n      html: labelContent,\n      deps: [],\n    };\n  }\n\n  if (labelContent.html === \"\") {\n    labelNode.addClass(\"shiny-label-null\");\n  } else {\n    await shinyRenderContent(labelNode, labelContent);\n    labelNode.removeClass(\"shiny-label-null\");\n  }\n}\n\nexport {\n  InputBinding,\n  registerBinding,\n  registerBslibGlobal,\n  hasDefinedProperty,\n  doWindowResizeOnElementResize,\n  getAllFocusableChildren,\n  shinyRenderContent,\n  showShinyClientMessage,\n  Shiny,\n  updateLabel,\n};\nexport type { HtmlDep, ShinyClientMessage };\n", "/**\n * @fileoverview Code Editor Web Component for bslib\n *\n * A Shiny input binding that creates a code editor using prism-code-editor\n * with syntax highlighting, theme support, and bidirectional communication\n * with R/Shiny.\n *\n * This file is built as a separate ES module bundle (code-editor.js) to\n * enable lazy loading - prism-code-editor and language grammars are only\n * loaded when the editor is used.\n */\n\nimport type { CustomElementInputGetValue } from \"./webcomponents/_makeInputBinding\";\nimport { makeInputBinding } from \"./webcomponents/_makeInputBinding\";\nimport {\n  hasDefinedProperty,\n  showShinyClientMessage,\n  updateLabel,\n} from \"./_utils\";\n\n// Default values - should match R defaults in input-code-editor.R\n/* eslint-disable @typescript-eslint/naming-convention */\nconst DEFAULT_LANGUAGE = \"plain\";\nconst DEFAULT_TAB_SIZE = 2;\nconst DEFAULT_THEME_LIGHT = \"github-light\";\nconst DEFAULT_THEME_DARK = \"github-dark\";\nconst SUBMIT_FLASH_DURATION_MS = 400;\n/* eslint-enable @typescript-eslint/naming-convention */\n\n// Type definitions for prism-code-editor\ninterface PrismEditor {\n  value: string;\n  keyCommandMap: {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    Enter?: (\n      e: KeyboardEvent,\n      selection: unknown,\n      value: string\n    ) => boolean | undefined;\n    [key: string]: unknown;\n  };\n  setOptions(options: PrismEditorOptions): void;\n  update(): void;\n}\n\ninterface PrismEditorOptions {\n  language?: string;\n  value?: string;\n  tabSize?: number;\n  insertSpaces?: boolean;\n  lineNumbers?: boolean;\n  wordWrap?: boolean;\n  readOnly?: boolean;\n}\n\ninterface PrismCodeEditorModule {\n  createEditor: (\n    element: HTMLElement,\n    options: PrismEditorOptions,\n    ...extensions: any[]\n  ) => PrismEditor;\n}\n\ninterface CopyButtonModule {\n  copyButton: () => any;\n}\n\ninterface CommandsModule {\n  defaultCommands: () => any;\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\ntype CodeEditorReceiveMessageData = {\n  value?: string;\n  label?: string;\n  /* eslint-disable @typescript-eslint/naming-convention */\n  tab_size?: number;\n  indentation?: \"space\" | \"tab\";\n  read_only?: boolean;\n  line_numbers?: boolean;\n  word_wrap?: boolean;\n  language?: string;\n  theme_light?: string;\n  theme_dark?: string;\n  /* eslint-enable @typescript-eslint/naming-convention */\n};\n\n/**\n * A code editor web component with syntax highlighting and Shiny integration.\n *\n * Uses prism-code-editor internally. Supports 20+ languages, light/dark themes,\n * and automatic theme switching based on Bootstrap's `data-bs-theme` attribute.\n *\n * @example\n * ```html\n * <bslib-code-editor\n *   id=\"my-editor\"\n *   language=\"python\"\n *   value=\"print('hello')\"\n *   theme-light=\"github-light\"\n *   theme-dark=\"github-dark\"\n * ></bslib-code-editor>\n * ```\n */\nexport class BslibCodeEditor\n  extends HTMLElement\n  implements CustomElementInputGetValue<string>\n{\n  static tagName = \"bslib-code-editor\";\n  static isShinyInput = true;\n\n  static observedAttributes = [\n    \"language\",\n    \"readonly\",\n    \"line-numbers\",\n    \"word-wrap\",\n    \"tab-size\",\n    \"insert-spaces\",\n    \"theme-light\",\n    \"theme-dark\",\n  ];\n\n  // Shared state across all instances\n  static #loadedLanguages = new Set<string>();\n  static #loadedThemes = new Set<string>();\n  static #basePath: string | null = null;\n\n  /** Locates and caches the base path for prism-code-editor assets. */\n  static #getBasePath(): string {\n    if (BslibCodeEditor.#basePath !== null) {\n      return BslibCodeEditor.#basePath;\n    }\n\n    const scriptElement = document.querySelector(\n      'script[src*=\"prism-code-editor\"][src$=\"index.js\"]'\n    );\n\n    if (!scriptElement) {\n      throw new Error(\n        \"Could not find prism-code-editor script element. \" +\n          \"Ensure the prism-code-editor dependency is properly loaded.\"\n      );\n    }\n\n    const src = scriptElement.getAttribute(\"src\");\n    if (!src) {\n      throw new Error(\"prism-code-editor script element has no src attribute\");\n    }\n\n    const absoluteSrc = new URL(src, document.baseURI).href;\n    BslibCodeEditor.#basePath = absoluteSrc.replace(/\\/index\\.js$/, \"\");\n    return BslibCodeEditor.#basePath;\n  }\n\n  /** Dynamically imports a language grammar. Cached after first load. */\n  static async #loadLanguage(language: string): Promise<void> {\n    if (BslibCodeEditor.#loadedLanguages.has(language)) {\n      return;\n    }\n    if ([\"plain\", \"plaintext\", \"text\", \"txt\"].includes(language)) {\n      return;\n    }\n    let languageToLoad = language;\n    if (language === \"html\") {\n      languageToLoad = \"markup\";\n    }\n    const basePath = BslibCodeEditor.#getBasePath();\n    await import(`${basePath}/prism/languages/${languageToLoad}.js`);\n    BslibCodeEditor.#loadedLanguages.add(language);\n  }\n\n  /** Loads a theme stylesheet. Themes are cached and never unloaded. */\n  static #loadTheme(themeName: string): void {\n    if (BslibCodeEditor.#loadedThemes.has(themeName)) {\n      return;\n    }\n\n    const linkId = `code-editor-theme-${themeName}`;\n    if (document.getElementById(linkId)) {\n      BslibCodeEditor.#loadedThemes.add(themeName);\n      return;\n    }\n\n    const basePath = BslibCodeEditor.#getBasePath();\n    const newLink = document.createElement(\"link\");\n    newLink.id = linkId;\n    newLink.rel = \"stylesheet\";\n    newLink.href = `${basePath}/themes/${themeName}.css`;\n\n    newLink.addEventListener(\"load\", () => {\n      BslibCodeEditor.#loadedThemes.add(themeName);\n    });\n\n    newLink.addEventListener(\"error\", () => {\n      console.error(`Failed to load code editor theme: ${themeName}`);\n    });\n\n    document.head.appendChild(newLink);\n  }\n\n  private prismEditor?: PrismEditor;\n  private darkLightObserver?: MutationObserver;\n  private initPromise?: Promise<PrismEditor | undefined>;\n  private languageChangePromise?: Promise<void>;\n\n  // Properties that reflect to/from HTML attributes\n  get language(): string {\n    return this.getAttribute(\"language\") ?? DEFAULT_LANGUAGE;\n  }\n  set language(val: string) {\n    this.setAttribute(\"language\", val);\n  }\n\n  get readonly(): boolean {\n    return (\n      this.hasAttribute(\"readonly\") && this.getAttribute(\"readonly\") !== \"false\"\n    );\n  }\n  set readonly(val: boolean) {\n    this.setAttribute(\"readonly\", String(val));\n  }\n\n  get lineNumbers(): boolean {\n    return this.getAttribute(\"line-numbers\") !== \"false\";\n  }\n  set lineNumbers(val: boolean) {\n    this.setAttribute(\"line-numbers\", String(val));\n  }\n\n  get wordWrap(): boolean {\n    return this.getAttribute(\"word-wrap\") === \"true\";\n  }\n  set wordWrap(val: boolean) {\n    this.setAttribute(\"word-wrap\", String(val));\n  }\n\n  get tabSize(): number {\n    const val = this.getAttribute(\"tab-size\");\n    const parsed = val ? parseInt(val) : DEFAULT_TAB_SIZE;\n    return isNaN(parsed) ? DEFAULT_TAB_SIZE : parsed;\n  }\n  set tabSize(val: number) {\n    this.setAttribute(\"tab-size\", String(val));\n  }\n\n  get insertSpaces(): boolean {\n    return this.getAttribute(\"insert-spaces\") !== \"false\";\n  }\n  set insertSpaces(val: boolean) {\n    this.setAttribute(\"insert-spaces\", String(val));\n  }\n\n  get themeLight(): string {\n    return this.getAttribute(\"theme-light\") ?? DEFAULT_THEME_LIGHT;\n  }\n  set themeLight(val: string) {\n    this.setAttribute(\"theme-light\", val);\n  }\n\n  get themeDark(): string {\n    return this.getAttribute(\"theme-dark\") ?? DEFAULT_THEME_DARK;\n  }\n  set themeDark(val: string) {\n    this.setAttribute(\"theme-dark\", val);\n  }\n\n  /** The current editor content. */\n  get value(): string {\n    return this.prismEditor?.value ?? \"\";\n  }\n  set value(val: string) {\n    if (this.prismEditor) {\n      this.prismEditor.setOptions({ value: val });\n    }\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onChangeCallback: (x: boolean) => void = () => {};\n\n  /** Returns the current editor content for Shiny. */\n  getValue(): string {\n    return this.value;\n  }\n\n  /** Initializes the editor when the element is added to the DOM. */\n  connectedCallback(): void {\n    // Guard against re-initialization (e.g., element moved in DOM)\n    if (this.prismEditor) return;\n\n    this.initPromise = this._initializeEditor();\n    this.initPromise\n      .then(() => {\n        this.onChangeCallback(false);\n      })\n      .catch((error) => {\n        showShinyClientMessage({\n          headline: \"Code Editor Initialization Error\",\n          message:\n            \"An error occurred while initializing the code editor. See console for details.\",\n          status: \"error\",\n        });\n        console.error(\"Failed to initialize code editor:\", error);\n      });\n\n    const updateCallback = (): void => this.onChangeCallback(true);\n    this.addEventListener(\"codeEditorUpdate\", updateCallback);\n  }\n\n  /** Cleans up observers when the element is removed from the DOM. */\n  disconnectedCallback(): void {\n    this.darkLightObserver?.disconnect();\n    this.darkLightObserver = undefined;\n    // Theme stylesheets are intentionally kept (shared across editors)\n  }\n\n  /** Responds to attribute changes by updating the prism-code-editor instance. */\n  attributeChangedCallback(\n    name: string,\n    oldValue: string | null,\n    newValue: string | null\n  ): void {\n    if (oldValue === newValue || !this.prismEditor) return;\n\n    const editor = this.prismEditor;\n\n    switch (name) {\n      case \"language\":\n        if (newValue) {\n          // Store promise so receiveMessage() can await language loading\n          this.languageChangePromise = this._handleLanguageChange(newValue);\n        }\n        break;\n      case \"readonly\":\n        editor.setOptions({ readOnly: newValue === \"true\" });\n        break;\n      case \"line-numbers\":\n        editor.setOptions({ lineNumbers: newValue !== \"false\" });\n        break;\n      case \"word-wrap\":\n        editor.setOptions({ wordWrap: newValue === \"true\" });\n        break;\n      case \"tab-size\": {\n        const tabSize = newValue ? parseInt(newValue) : DEFAULT_TAB_SIZE;\n        if (!isNaN(tabSize)) {\n          editor.setOptions({ tabSize });\n        }\n        break;\n      }\n      case \"insert-spaces\":\n        editor.setOptions({ insertSpaces: newValue !== \"false\" });\n        break;\n      case \"theme-light\":\n        if (newValue) BslibCodeEditor.#loadTheme(newValue);\n        break;\n      case \"theme-dark\":\n        if (newValue) BslibCodeEditor.#loadTheme(newValue);\n        break;\n      default:\n        break;\n    }\n  }\n\n  /** Creates the prism-code-editor instance and sets up event handlers. */\n  private async _initializeEditor(): Promise<PrismEditor | undefined> {\n    const editorContainer = this.querySelector(\".code-editor\");\n    if (!editorContainer) {\n      showShinyClientMessage({\n        headline: \"Code Editor Initialization Error\",\n        message:\n          \"Expected to find `.code-editor` inside `<bslib-code-editor>` container element.\",\n        status: \"error\",\n      });\n      return;\n    }\n\n    const language = this.language;\n    const initialCode = this.getAttribute(\"value\") ?? \"\";\n    this.removeAttribute(\"value\"); // Clean up; value now lives in prismEditor\n    const readOnly = this.readonly;\n    const lineNumbers = this.lineNumbers;\n    const wordWrap = this.wordWrap;\n    const tabSize = this.tabSize;\n    const insertSpaces = this.insertSpaces;\n\n    const basePath = BslibCodeEditor.#getBasePath();\n\n    // Language grammar must load before editor creation\n    await BslibCodeEditor.#loadLanguage(language);\n    const [{ createEditor }, { copyButton }, { defaultCommands }] =\n      await Promise.all([\n        import(`${basePath}/index.js`) as Promise<PrismCodeEditorModule>,\n        import(\n          `${basePath}/extensions/copyButton/index.js`\n        ) as Promise<CopyButtonModule>,\n        import(`${basePath}/extensions/commands.js`) as Promise<CommandsModule>,\n      ]);\n\n    const editor = createEditor(\n      editorContainer as HTMLElement,\n      {\n        language: language,\n        value: initialCode,\n        tabSize: tabSize,\n        insertSpaces: insertSpaces,\n        lineNumbers: lineNumbers,\n        wordWrap: wordWrap,\n        readOnly: readOnly,\n      },\n      copyButton(),\n      defaultCommands()\n    );\n\n    const oldEnterCallback = editor.keyCommandMap.Enter;\n    editor.keyCommandMap.Enter = (\n      e: KeyboardEvent,\n      selection: unknown,\n      value: string\n    ) => {\n      if (e.metaKey || e.ctrlKey) {\n        this.dispatchEvent(new CustomEvent(\"codeEditorUpdate\"));\n        editorContainer.classList.add(\"code-editor-submit-flash\");\n        setTimeout(() => {\n          editorContainer.classList.remove(\"code-editor-submit-flash\");\n        }, SUBMIT_FLASH_DURATION_MS);\n        return true;\n      }\n      return oldEnterCallback?.(e, selection, value);\n    };\n\n    this.prismEditor = editor;\n    this.darkLightObserver = this._setupThemeWatcher();\n\n    const textarea = this.querySelector(\"textarea\");\n    if (textarea) {\n      textarea.addEventListener(\"blur\", () => {\n        this.dispatchEvent(new CustomEvent(\"codeEditorUpdate\"));\n      });\n    }\n\n    return editor;\n  }\n\n  /** Watches `data-bs-theme` on `<html>` to switch syntax highlighting themes. */\n  private _setupThemeWatcher(): MutationObserver {\n    const updateTheme = (): void => {\n      const htmlEl = document.documentElement;\n      const theme = htmlEl.getAttribute(\"data-bs-theme\");\n      const themeName = theme === \"dark\" ? this.themeDark : this.themeLight;\n      BslibCodeEditor.#loadTheme(themeName);\n    };\n    updateTheme();\n\n    const observer = new MutationObserver(() => updateTheme());\n    observer.observe(document.documentElement, {\n      attributes: true,\n      attributeFilter: [\"data-bs-theme\"],\n    });\n    return observer;\n  }\n\n  /** Loads a new language grammar and updates the editor. */\n  private async _handleLanguageChange(newLanguage: string): Promise<void> {\n    const editor = this.prismEditor;\n    if (!editor) return;\n\n    try {\n      await BslibCodeEditor.#loadLanguage(newLanguage);\n      editor.setOptions({ language: newLanguage });\n      editor.update();\n    } catch (error) {\n      showShinyClientMessage({\n        headline: \"Code Editor Language Load Error\",\n        message: `Failed to load language '${newLanguage}'. See console for details.`,\n        status: \"error\",\n      });\n      console.error(`Failed to load language '${newLanguage}':`, error);\n    }\n  }\n\n  /**\n   * Handles messages from Shiny's `update_code_editor()`.\n   * @param el - The element (unused, required by interface)\n   * @param data - Update data from R\n   */\n  async receiveMessage(\n    el: HTMLElement,\n    data: CodeEditorReceiveMessageData\n  ): Promise<void> {\n    if (this.initPromise) {\n      await this.initPromise;\n    }\n\n    if (!this.prismEditor) {\n      showShinyClientMessage({\n        headline: \"Code Editor could not update\",\n        message:\n          \"An update was ignored because the editor is not yet initialized.\",\n        status: \"warning\",\n      });\n      return;\n    }\n\n    if (hasDefinedProperty(data, \"value\")) {\n      this.value = data.value ?? \"\";\n    }\n\n    if (hasDefinedProperty(data, \"label\")) {\n      const labelEl = $(this).find(\"label\");\n      await updateLabel(data.label, labelEl);\n    }\n\n    // Properties set via setters trigger attributeChangedCallback\n    if (hasDefinedProperty(data, \"tab_size\") && data.tab_size !== undefined) {\n      this.tabSize = data.tab_size;\n    }\n    if (hasDefinedProperty(data, \"indentation\")) {\n      this.insertSpaces = data.indentation === \"space\";\n    }\n    if (hasDefinedProperty(data, \"read_only\") && data.read_only !== undefined) {\n      this.readonly = data.read_only;\n    }\n    if (\n      hasDefinedProperty(data, \"line_numbers\") &&\n      data.line_numbers !== undefined\n    ) {\n      this.lineNumbers = data.line_numbers;\n    }\n    if (hasDefinedProperty(data, \"word_wrap\") && data.word_wrap !== undefined) {\n      this.wordWrap = data.word_wrap;\n    }\n    if (hasDefinedProperty(data, \"language\") && data.language) {\n      this.language = data.language;\n      // Wait for async language loading before notifying Shiny\n      if (this.languageChangePromise) {\n        await this.languageChangePromise;\n        this.languageChangePromise = undefined;\n      }\n    }\n    if (hasDefinedProperty(data, \"theme_light\") && data.theme_light) {\n      this.themeLight = data.theme_light;\n    }\n    if (hasDefinedProperty(data, \"theme_dark\") && data.theme_dark) {\n      this.themeDark = data.theme_dark;\n    }\n\n    this.dispatchEvent(new CustomEvent(\"codeEditorUpdate\"));\n  }\n}\n\ncustomElements.define(BslibCodeEditor.tagName, BslibCodeEditor);\n\nif (window.Shiny) {\n  makeInputBinding<string>(BslibCodeEditor.tagName);\n}\n"],
  "mappings": "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",
  "names": ["makeInputBinding", "tagName", "type", "NewCustomBinding", "scope", "el", "callback", "x", "data", "Shiny", "InputBinding", "showShinyClientMessage", "headline", "message", "status", "hasDefinedProperty", "obj", "prop", "shinyRenderContent", "args", "__async", "Shiny", "updateLabel", "labelContent", "labelNode", "DEFAULT_LANGUAGE", "DEFAULT_TAB_SIZE", "DEFAULT_THEME_LIGHT", "DEFAULT_THEME_DARK", "SUBMIT_FLASH_DURATION_MS", "_loadedLanguages", "_loadedThemes", "_basePath", "_getBasePath", "getBasePath_fn", "_loadLanguage", "loadLanguage_fn", "_loadTheme", "loadTheme_fn", "_BslibCodeEditor", "_a", "val", "parsed", "_b", "error", "showShinyClientMessage", "updateCallback", "name", "oldValue", "newValue", "editor", "tabSize", "__privateMethod", "__async", "_c", "editorContainer", "language", "initialCode", "readOnly", "lineNumbers", "wordWrap", "insertSpaces", "basePath", "createEditor", "copyButton", "defaultCommands", "oldEnterCallback", "e", "selection", "value", "textarea", "updateTheme", "themeName", "observer", "newLanguage", "el", "data", "hasDefinedProperty", "labelEl", "updateLabel", "BslibCodeEditor", "__privateGet", "scriptElement", "src", "absoluteSrc", "__privateSet", "languageToLoad", "linkId", "newLink", "__privateAdd", "makeInputBinding"]
}
