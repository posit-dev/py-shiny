{"version":3,"file":"index.js","sources":["../../../src/extensions/copyButton/index.ts"],"sourcesContent":["/** @module copy-button */\r\n\r\nimport { addListener, createTemplate, doc } from \"../../core.js\"\r\nimport { BasicExtension } from \"../../types.js\"\r\nimport { addOverlay, setSelection } from \"../../utils/index.js\"\r\n\r\n/**\r\n * Creates a static copy button that can be added to the overlays of an editor or code\r\n * block. The `firstChild` of the element returned is the button itself.\r\n */\r\nconst createCopyButton = /* @__PURE__ */ createTemplate(\r\n\t'<div style=display:flex;align-items:flex-start;justify-content:flex-end><button type=button dir=ltr style=display:none class=pce-copy aria-label=Copy><svg width=1.2em aria-hidden=true viewBox=\"0 0 16 16\" overflow=visible stroke-linecap=round fill=none stroke=currentColor><rect x=4 y=4 width=11 height=11 rx=1 /><path d=\"m12 2a1 1 0 00-1-1H2A1 1 0 001 2v9a1 1 0 001 1\">',\r\n)\r\n\r\n/**\r\n * Extension that adds a copy button to the editor.\r\n * Probably best used with a read-only editor.\r\n * You must also import styles from `prism-code-editor/copy-button.css`.\r\n */\r\nconst copyButton = (): BasicExtension => editor => {\r\n\tconst container = createCopyButton()\r\n\tconst btn = <HTMLButtonElement>container.firstChild!\r\n\r\n\taddListener(btn, \"click\", () => {\r\n\t\tbtn.setAttribute(\"aria-label\", \"Copied!\")\r\n\t\tif (!navigator.clipboard?.writeText(editor.extensions.codeFold?.fullCode ?? editor.value)) {\r\n\t\t\teditor.textarea.select()\r\n\t\t\tdoc!.execCommand(\"copy\")\r\n\t\t\tsetSelection(editor, 0)\r\n\t\t}\r\n\t})\r\n\r\n\taddListener(btn, \"pointerenter\", () => btn.setAttribute(\"aria-label\", \"Copy\"))\r\n\r\n\taddOverlay(editor, container)\r\n}\r\n\r\nexport { copyButton, createCopyButton }\r\n"],"names":[],"mappings":";;AAUA,MAAM,mBAAmC;AAAA,EACxC;AACD;AAOA,MAAM,aAAa,MAAsB,CAAA,WAAU;AAClD,QAAM,YAAY,iBAAA;AAClB,QAAM,MAAyB,UAAU;AAEzC,cAAY,KAAK,SAAS,MAAM;AAC/B,QAAI,aAAa,cAAc,SAAS;AACxC,QAAI,CAAC,UAAU,WAAW,UAAU,OAAO,WAAW,UAAU,YAAY,OAAO,KAAK,GAAG;AAC1F,aAAO,SAAS,OAAA;AAChB,UAAK,YAAY,MAAM;AACvB,mBAAa,QAAQ,CAAC;AAAA,IACvB;AAAA,EACD,CAAC;AAED,cAAY,KAAK,gBAAgB,MAAM,IAAI,aAAa,cAAc,MAAM,CAAC;AAE7E,aAAW,QAAQ,SAAS;AAC7B;"}